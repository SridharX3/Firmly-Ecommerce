import{w as m}from"./BkELfgbM.js";import{a,C as e}from"./B7eymPUq.js";import{D as l}from"./C0j6wI00.js";const o=m({items:[],subtotal:0,currency:"USD",loading:!1,error:null});async function i(){o.update(r=>({...r,loading:!0,error:null}));try{const r=await a(`${e}/cart`,{credentials:"include"});if(r.error)throw new Error(r.error);o.set({items:r.items??[],subtotal:r.subtotal??0,currency:r.currency??"USD",loading:!1,error:null})}catch(r){o.update(t=>({...t,loading:!1,error:r.message}))}}async function E(r,t=1){const s=l(o).items.find(u=>u.product_id===r);if(s)return d(r,s.quantity+t);const c=await a(`${e}/cart/items`,{method:"POST",body:JSON.stringify({product_id:Number(r),quantity:Number(t)})});if(c.error)throw new Error(c.error);await i()}async function d(r,t){if(t<1)return f(r);const n=await a(`${e}/cart/items/${r}`,{method:"PATCH",body:JSON.stringify({quantity:Number(t)})});if(n.error)throw new Error(n.error);await i()}async function f(r){const t=await a(`${e}/cart/items/${r}`,{method:"DELETE"});if(t.error)throw new Error(t.error);await i()}async function b(){const r=await a(`${e}/cart`,{method:"DELETE"});if(r.error)throw new Error(r.error);await i()}export{o as a,E as b,b as c,i as l,f as r,d as u};
